# Song Genre Classification Based on Lyrics

This project is designed to classify the genre of a song based on its lyrics using a Naive Bayes classifier. The project involves several stages, including data preparation, model training, and a graphical interface for user interaction. Below is a detailed description of the steps involved in running the project.

## Data Preparation

### Lemmatization
The first step in preparing the data was lemmatization, which involves reducing words to their base form. This was necessary to standardize the lyrics by removing inflectional endings and accounting for the semantic and grammatical properties of words.

The database used for this project was sourced from [Kaggle](https://www.kaggle.com/datasets/neisse/scrapped-lyrics-from-6-genres?select=lyrics-data.csv). The dataset includes a large collection of song lyrics, along with the artists who performed them and the associated music genres.

### Data Cleaning and Processing
After merging the lyrics and artist databases, we filtered out non-English songs and removed irrelevant columns such as `SLink`, `language`, `Songs`, and `Popularity`. The resulting dataset was further cleaned by removing words that do not contribute to genre classification, such as common stop words, punctuation marks, and special symbols.

The final dataset was split into training and testing sets, with 80% used for training the model and 20% for testing its performance.

## Implementation

### Naive Bayes Classifier
The core of the project is the Naive Bayes classifier, which uses Bayes' theorem to calculate the probability of a song belonging to a specific genre based on the frequency of words in that genre. The classifier was trained using the prepared dataset, and the results were saved for later use.

### Graphical Interface
To make the model user-friendly, a graphical interface was developed using `tkinter`. This interface allows users to select a text file containing song lyrics and classify its genre. The interface displays the most probable genre along with a bar chart showing the probabilities of different genres.

### How to Run the Project

1. **Data Lemmatization and Preparation**:
   - Run the script that processes and lemmatizes the lyrics data. This is done using the `lemmatization.py` script. The data must first be cleaned, lemmatized, and split into training and test datasets.
   - The prepared dataset is saved in the `csv` directory.

2. **Training the Naive Bayes Model**:
   - The model is trained using the `bayes.py` script, which reads the prepared dataset, trains the Naive Bayes classifier, and saves the trained model along with the serialized word dictionaries.

3. **Running the Graphical Interface**:
   - To use the graphical interface and classify a song's genre based on its lyrics, run the `graphic_interface.py` script.
   - You can select a `.txt` file containing the lyrics of a song, and the model will classify its genre. A bar chart will be displayed showing the probabilities of each genre.
   - Sample song lyrics in `.txt` format are provided in the `Song lyrics` directory for testing.

### Required Libraries

The project uses several Python libraries including:
- `spacy` for lemmatization.
- `pandas` for data handling.
- `matplotlib` for plotting results.
- `tkinter` and `PIL` for the graphical interface.
- `pickle` and `gzip` for saving and loading model data.

### How to Set Up

1. **Install Dependencies**:
   - Make sure you have Python 3.8 or later installed.
   - Install the required Python libraries using pip:
     ```bash
     pip install spacy pandas matplotlib pillow
     ```
   - Download the `en_core_web_md` model for `spacy`:
     ```bash
     python -m spacy download en_core_web_md
     ```

2. **Run the Scripts**:
   - To prepare and process the data, run the respective scripts (`lemmatization.py`, `bayes.py`).
   - To use the graphical interface, simply run `graphic_interface.py`.

### File Structure

- **data/**: Contains serialized data files (e.g., `compressed_data.json.gz`).
- **csv/**: Contains processed datasets (e.g., `training_database_v36.csv`, `test_database_v36.csv`).
- **Song lyrics/**: Contains sample song lyrics in `.txt` format for testing.
- **plots/**: Contains the bar chart image generated by the interface.
- **instance.pickle**: The saved model instance.
- **bayes.py**: Script implementing the Naive Bayes classifier.
- **graphic_interface.py**: Script for the graphical user interface.
- **lemmatization.py**: Script for processing and lemmatizing the lyrics data.

### Summary
This project provides a robust method for classifying music genres based on song lyrics. The use of a Naive Bayes classifier and a user-friendly graphical interface makes it accessible for both technical and non-technical users to classify songs easily.
